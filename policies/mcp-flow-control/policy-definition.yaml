name: mcp-flow-control
version: v0.1.0
description: |
  MCP Flow Control policy defines allowed tools, resources, and prompts
  and controls what is returned in MCP list responses. Each entry can include
  a user-facing name plus additional metadata, and an optional "target" field
  that maps to the backend capability name. When a target is provided, the
  request is rewritten to use the backend capability name, while list responses
  are rewritten to return the policy-defined entries.

  - Null or omitted: Allow all capabilities of that type
  - Empty array []: Deny all capabilities of that type
  - Non-empty array: Allow only the specified capabilities

parameters:
  type: object
  additionalProperties: false
  properties:
    tools:
      type: array
      description: |
        List of allowed tools. When provided (non-empty), only these tools are allowed.
        Each entry must include "name" and may include "target" plus any additional
        fields to be returned in tools/list responses.
      items:
        type: object
        additionalProperties: true
        required:
          - name
          - description
          - inputSchema
        properties:
          name:
            type: string
            description: User-facing tool name exposed to clients.
            minLength: 1
            maxLength: 256
          description:
            type: string
            description: User-facing tool description returned in tools/list.
            minLength: 1
          inputSchema:
            type: string
            description: Tool input schema returned in tools/list.
            minLength: 1
          outputSchema:
            type: string
            description: Tool output schema returned in tools/list.
            minLength: 1
          target:
            type: string
            description: Backend tool name to use when forwarding requests.
            minLength: 1
            maxLength: 256
    resources:
      type: array
      description: |
        List of allowed resources. When provided (non-empty), only these resources are allowed.
        Each entry must include "name" and may include "target" plus any additional
        fields to be returned in resources/list responses.
      items:
        type: object
        additionalProperties: true
        required:
          - name
          - uri
        properties:
          name:
            type: string
            description: User-facing resource identifier (URI) exposed to clients.
            minLength: 1
            maxLength: 1024
          description:
            type: string
            description: User-facing resource description returned in resources/list.
            minLength: 1
          uri:
            type: string
            description: User-facing resource URI returned in resources/list.
            minLength: 1
            maxLength: 2048
          target:
            type: string
            description: Backend resource identifier (URI) to use when forwarding requests.
            minLength: 1
            maxLength: 1024
    prompts:
      type: array
      description: |
        List of allowed prompts. When provided (non-empty), only these prompts are allowed.
        Each entry must include "name" and may include "target" plus any additional
        fields to be returned in prompts/list responses.
      items:
        type: object
        additionalProperties: true
        required:
          - name
        properties:
          name:
            type: string
            description: User-facing prompt name exposed to clients.
            minLength: 1
            maxLength: 256
          description:
            type: string
            description: User-facing prompt description returned in prompts/list.
            minLength: 1
          target:
            type: string
            description: Backend prompt name to use when forwarding requests.
            minLength: 1
            maxLength: 256

systemParameters:
  type: object
  properties: {}
